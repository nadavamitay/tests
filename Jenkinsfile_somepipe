

node {
        
    stage ("initialization") {
        
        print("Initializing pipeline...")    
        checkout scmGit(branches: [[name: '*/main']], extensions: [], userRemoteConfigs: [[url: 'https://github.com/nadavamitay/tests.git']])
    }
    
    stage ("building"){
        
        print("Building the project...")
        def parallelTasks = [:]
        
        if ( env.BUILD_ENV == "componentA" || env.BUILD_ENV == ""){
            parallelTasks["Building component A"] = {
                print("Building component A")
            }
        }
        
        if ( env.BUILD_ENV == "componentB" || env.BUILD_ENV == ""){
            parallelTasks["Building component B"] = {
                print("Building component B")                
            }
        }

        parallel parallelTasks
    }
    
    stage ("post-build"){
        archiveArtifacts artifacts: '**/README.md', allowEmptyArchive: true
        
             
    }
}
